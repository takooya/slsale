<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.slsale.dao.FunctionMapper">
    <select id="getMainFunctionList" parameterType="authority" resultType="function">
        SELECT *
        FROM au_function
        WHERE au_function.`parentId` = 0 AND au_function.`id` IN
                                             (SELECT au_authority.`functionId`
                                              FROM au_authority
                                              WHERE au_authority.`roleId` = #{roleId})
    </select>
    <select id="getSubFunctionList" parameterType="function" resultType="function">
        SELECT *
        FROM au_function
        WHERE au_function.`parentId` = #{id} AND au_function.`id` IN
                                                 (SELECT au_authority.`functionId`
                                                  FROM au_authority
                                                  WHERE au_authority.`roleId` = #{roleId})
    </select>
    <select id="getSubFuncList" parameterType="function" resultType="function">
        SELECT *
        FROM au_function
        WHERE au_function.`parentId` = #{id}
    </select>
    <select id="getFuncListByIn" parameterType="String" resultType="function">
        SELECT *
        FROM au_function
        WHERE au_function.`id`
              IN (${idsSqlString})
              OR parentId IN (SELECT id
                              FROM au_function
                              WHERE au_function.`id` IN (${idsSqlString})
                                    AND au_function.parentId > 0)
              OR parentId = 999;
    </select>
    <select id="getFunctionUrlByRoreId" parameterType="authority" resultType="function">
        SELECT funcUrl
        FROM au_function
        WHERE id IN (SELECT functionId
                     FROM au_authority
                     WHERE roleId = #{roleId}) AND parentId > 0;
    </select>

</mapper>